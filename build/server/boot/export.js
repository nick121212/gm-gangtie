var csv=require("csv"),fs=require("fs"),path=require("path");module.exports=function(a){var b=a.loopback.Router();b.get("/export_gift",function(a,b,c){var d,e=a.query.name||"gift",f=a.query.filename||"1.txt";d=fs.createReadStream(path.join("gifts",f)),b.writeHead(200,{"Content-Type":"application/octet-stream;charset=utf8","Coneten-Length":100,"Content-Disposition":'attachment; filename="'+encodeURIComponent(e+".csv")+'"'}),d.pipe(csv.parse()).pipe(csv.stringify()).pipe(b),d.on("error",function(a){c(a)})}),a.use(b)};