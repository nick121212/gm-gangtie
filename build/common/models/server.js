var async=require("async"),Promise=require("bluebird"),_=require("lodash");module.exports=function(a){a.setDefault=function(b,c){async.auto({trans:function(b){a.beginTransaction({isolationLevel:a.Transaction.READ_COMMITTED},b)},"delete":["trans",function(b,c){a.dataSource.connector.execute("update server set isDefault=false",[],{transaction:c.trans},b)}],insert:["trans","delete",function(c,d){a.dataSource.connector.execute("update server set isDefault=true where serID=?",[b],{transaction:d.trans},c)}],commit:["insert",function(a,b){b.trans.commit(a)}]},function(a,b){return a?void c(a):void c(null,null)})},a.remoteMethod("setDefault",{accepts:[{arg:"id",type:"number",required:!0}],returns:{root:!0,type:"object"},http:{verb:"post",path:"/:id/set_default"}})};